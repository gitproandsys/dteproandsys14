<?xml version="1.0" encoding="utf-8" ?>
<odoo>
    <record id="action_report_tbx" model="ir.actions.report">
        <field name="name">Balance Tributario XLSX</field>
        <field name="model">trial.balance.report.wizard</field>
        <field name="type">ir.actions.report</field>
        <field name="report_name">proandsys_reportes_chile_14.report_tbx</field>
        <field name="report_type">xlsx</field>
        <field name="report_file">report_trial_balance</field>
    </record>
    <report
        id="action_report_trial_balance_qweb"
        model="trial.balance.report.wizard"
        string="Balance Tributario"
        menu="False"
        report_type="qweb-pdf"
        name="proandsys_reportes_chile_14.trial_balance"
        file="proandsys_reportes_chile_14.trial_balance"
    />
    <template id="trial_balance">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="o">
                <t t-call="account_financial_report.internal_layout">
                    <!-- <t t-call="web.external_layout"> -->
                        <t t-call="proandsys_reportes_chile_14.report_trial_balance_base" />
                    <!-- </t> -->
                </t>
            </t>
        </t>
    </template>
    <template id="report_trial_balance_base">
        <!-- Saved flag fields into variables, used to define columns display -->
        <t t-set="show_partner_details" t-value="show_partner_details" />
        <t t-set="foreign_currency" t-value="foreign_currency" />
        <t t-set="show_hierarchy_level" t-value="show_hierarchy_level" />
        <t t-set="limit_hierarchy_level" t-value="limit_hierarchy_level" />
        <!-- Defines global variables used by internal layout -->
        <t t-set="title">Balance Tributario - <t t-raw="company_name" /> - <t
                t-raw="currency_name"
            /></t>
        <t t-set="company_name" t-value="Company_Name" />
        <!--       <t t-set="res_company" t-value="company_id"/>-->
        <t class="page">
            <div class="row">
                <h4
                    class="mt0"
                    t-esc="title or 'Odoo Report'"
                    style="text-align: center;"
                />
            </div>
            <!-- Display filters -->
            <!-- <t t-call="proandsys_reportes_chile_14.report_trial_balance_filters" /> -->
            <div class="act_as_table list_table" style="margin-top: 10px;" />
            <!-- Display account lines -->
            <t t-if="not show_partner_details">
                <div class="act_as_table data_table" style="width: 100%;">
                    <!-- Display account header -->
                    <t
                        t-call="proandsys_reportes_chile_14.report_trial_balance_lines_header"
                    />
                    <!-- Display each lines -->
                    <t t-set="acumulador_debe" t-value="0"/>
                    <t t-set="acumulador_haber" t-value="0"/>
                    <t t-set="acumulador_deudor" t-value="0"/>
                    <t t-set="acumulador_acreedor" t-value="0"/>
                    <t t-set="acumulador_activo" t-value="0"/>
                    <t t-set="acumulador_pasivo" t-value="0"/>
                    <t t-set="acumulador_perdida" t-value="0"/>
                    <t t-set="acumulador_ganancia" t-value="0"/>
                    <t t-set="resultado_activo" t-value="0"/>
                    <t t-set="resultado_pasivo" t-value="0"/>
                    <t t-set="resultado_perdida" t-value="0"/>
                    <t t-set="resultado_ganancia" t-value="0"/>
                    <t t-set="debit" t-value="0"/>
                    <t t-set="credit" t-value="0"/>
                    
                    
                    <t t-set="account_ids_list" t-value="map(lambda r: r['id'],trial_balance)"/>
                    <t t-set="account_ids" t-value="o.env['account.account'].browse(account_ids_list)"/>

                    <t t-set="res_ejercicio_anterior_id" t-value="account_ids.filtered(lambda r: r.user_type_id.id==o.env.ref('account.data_unaffected_earnings').id)"/>
                    <t t-set="resultado_ejercicio_anterior" t-value="list(filter(lambda r: r['id']==res_ejercicio_anterior_id.id,trial_balance))[0]"/>


                    <t t-foreach="account_ids.filtered(lambda r: r.user_type_id.id != o.env.ref('account.data_unaffected_earnings').id)" t-as="line">
                        <t t-set="activo" t-value="0"/>
                        <t t-set="pasivo" t-value="0"/>
                        <t t-set="perdida" t-value="0"/>
                        <t t-set="ganancia" t-value="0"/>

                        <t t-set="balance" t-value="list(filter(lambda r: r['id']==line.id,trial_balance))[0]" />

                        <!-- Adapt -->
                        <t t-set="style" t-value="'font-size:12px;'" />
                        <t t-if="hierarchy_on == 'none'">
                            <t t-if="balance['initial_balance']&gt;0">
                                <t t-set="debit" t-value="balance['initial_balance']+balance['debit']"/>
                                <t t-set="credit" t-value="balance['credit']"/>
                            </t>
                            <t t-else="">
                                <t t-set="debit" t-value="balance['debit']"/>
                                <t t-set="credit" t-value="balance['credit']-balance['initial_balance']"/>
                            </t>

                            <t t-set="deudor" t-value="0"/>
                            <t t-set="acreedor" t-value="0"/>
                            <t t-set="acumulador_debe" t-value="acumulador_debe+debit"/>
                            <t t-set="acumulador_haber" t-value="acumulador_haber+credit"/>
                            <t t-if="debit&gt;credit">
                                <t t-set="deudor" t-value="debit-credit"/>
                                <t t-set="acumulador_deudor" t-value="acumulador_deudor+deudor"/>
                            </t>
                            <t t-if="debit&lt;credit">
                                <t t-set="acreedor" t-value="credit-debit"/>
                                <t t-set="acumulador_acreedor" t-value="acumulador_acreedor+acreedor"/>
                            </t>

                            <t t-if="line.user_type_id.report_type in ('asset','liability')">
                                <t t-set="activo" t-value="deudor"/>
                                <t t-set="pasivo" t-value="acreedor"/>
                                <t t-set="acumulador_activo" t-value="acumulador_activo+activo"/>
                                <t t-set="acumulador_pasivo" t-value="acumulador_pasivo+pasivo"/>
                            </t>
                            <t t-if="line.user_type_id.report_type in ('income','expense')">
                                <t t-set="perdida" t-value="deudor"/>
                                <t t-set="ganancia" t-value="acreedor"/>
                                <t t-set="acumulador_perdida" t-value="acumulador_perdida+perdida"/>
                                <t t-set="acumulador_ganancia" t-value="acumulador_ganancia+ganancia"/>
                            </t>
                            <t t-call="proandsys_reportes_chile_14.report_trial_balance_line"/>
                        </t>
                    </t>

                    <t t-call="proandsys_reportes_chile_14.report_balance_tributario_qweb_line_subtotales"/>
                    <t t-if="acumulador_activo&gt;acumulador_pasivo">
                        <t t-set="resultado_pasivo" t-value="acumulador_activo-acumulador_pasivo"/>
                    </t>
                    <t t-if="acumulador_pasivo&gt;acumulador_activo">
                        <t t-set="resultado_activo" t-value="acumulador_pasivo-acumulador_activo"/>
                    </t>
                    <t t-if="acumulador_ganancia&gt;acumulador_perdida">
                        <t t-set="resultado_perdida" t-value="acumulador_ganancia-acumulador_perdida"/>
                    </t>
                    <t t-if="acumulador_perdida&gt;acumulador_ganancia">
                        <t t-set="resultado_ganancia" t-value="acumulador_perdida-acumulador_ganancia"/>
                    </t>
                    <t t-call="proandsys_reportes_chile_14.report_balance_tributario_qweb_line_resultado"/>
                    <t t-call="proandsys_reportes_chile_14.report_balance_tributario_qweb_line_totales"/>
                    <t t-call="proandsys_reportes_chile_14.report_balance_tributario_qweb_ejercicio_anterior"/>



                </div>
            </t>
            <!-- Display partner lines -->

        </t>
    </template>
    <template id="proandsys_reportes_chile_14.report_trial_balance_filters">
        <div class="act_as_table data_table" style="width: 100%;">
            <div class="act_as_row labels">
                <div class="act_as_cell">Rango de fechas</div>
                <div class="act_as_cell">Filtro movimiento de destino</div>
                <div class="act_as_cell">Filtro por cuenta a 0</div>
                <div class="act_as_cell">Límite de niveles de jerarquía</div>
            </div>
            <div class="act_as_row">
                <div class="act_as_cell">
                    Desde: <span
                        t-esc="date_from"
                        t-options="{'widget': 'date'}"
                    /> Hasta: <span t-esc="date_to" t-options="{'widget': 'date'}" />
                </div>
                <div class="act_as_cell">
                    <t t-if="only_posted_moves">Todos los asientos asentados</t>
                    <t t-if="not only_posted_moves">Todas los asientos</t>
                </div>
                <div class="act_as_cell">
                    <t t-if="hide_account_at_0">Mostrar</t>
                    <t t-if="not hide_account_at_0">Ocultar</t>
                </div>
                <div class="act_as_cell">
                    <t t-if="limit_hierarchy_level">
                        Nivel <span t-esc="show_hierarchy_level" />
                    </t>
                    <t t-if="not limit_hierarchy_level">
                        Sin Límite
                    </t>
                </div>
            </div>
        </div>
    </template>
    <template id="proandsys_reportes_chile_14.report_trial_balance_lines_header">
        <!-- Display table headers for lines -->
        <div class="act_as_thead">
            <div class="act_as_row labels">
                <t t-if="not show_partner_details">
                    <!--## Code-->
                    <div class="act_as_cell" style="width: 12%;">Código</div>
                    <!--## Account-->
                    <div class="act_as_cell" style="width: 24%;">Cuenta</div>
                </t>
                <!--## Initial balance-->
                <!-- <div class="act_as_cell" style="width: 8%;">Saldo Inicial</div> -->
                <!--## Debit-->
                <div class="act_as_cell" style="width: 8%;">Débito</div>
                <!--## Credit-->
                <div class="act_as_cell" style="width: 8%;">Crédito</div>
                <!--## Deudor-->
                <div class="act_as_cell" style="width: 8%;">Deudor</div>
                <!--## Acreedor-->
                <div class="act_as_cell" style="width: 8%;">Acreedor</div>
                <!--## Activo-->
                <div class="act_as_cell" style="width: 8%;">Activo</div>
                <!--## pasivo-->
                <div class="act_as_cell" style="width: 8%;">Pasivo</div>
                <!--## perdida-->
                <div class="act_as_cell" style="width: 8%;">Pérdida</div>
                <!--## Ganancia-->
                <div class="act_as_cell" style="width: 8%;">Ganancia</div>

            </div>
        </div>
    </template>
    <template id="proandsys_reportes_chile_14.report_trial_balance_line">
        <!-- # line -->
        <div class="act_as_row lines">
            <t t-if="not show_partner_details">
                <!--## Code-->
                <t t-if="balance['type'] == 'account_type'">
                    <div class="act_as_cell left">
                        <!--                    <t t-if="accounts_data[account_id]['code']">-->
                        <t t-set="res_model" t-value="'account.account'" />
                        <span>
                            <a
                                t-att-data-active-id="balance['id']"
                                t-att-data-res-model="res_model"
                                class="o_account_financial_reports_web_action"
                                t-att-style="style"
                            >
                                <t t-att-style="style" t-esc="balance['code']" />
                            </a>
                        </span>
                    </div>
                    <!--            ## Account/Partner-->
                    <div class="act_as_cell left">
                        <t t-set="res_model" t-value="'account.account'" />
                        <span>
                            <a
                                t-att-data-active-id="balance['id']"
                                t-att-data-res-model="res_model"
                                class="o_account_financial_reports_web_action"
                                t-att-style="style"
                            >
                                <t t-att-style="style" t-esc="balance['name']" />
                            </a>
                        </span>
                    </div>
                </t>
                <!--## Cuenta-->
                <t t-if="balance['type'] == 'group_type'">
                    <div class="act_as_cell left">
                        <t t-set="res_model" t-value="'account.group'" />
                        <span>
                            <a
                                t-att-data-active-id="balance['id']"
                                t-att-data-res-model="res_model"
                                class="o_account_financial_reports_web_action"
                                t-att-style="style"
                            >
                                <t t-att-style="style" t-raw="balance['code']" />
                            </a>
                        </span>
                    </div>
                    <div class="act_as_cell left">
                        <t t-set="res_model" t-value="'account.group'" />
                        <span>
                            <a
                                t-att-data-active-id="balance['id']"
                                t-att-data-res-model="res_model"
                                class="o_account_financial_reports_web_action"
                                t-att-style="style"
                            >
                                <t t-att-style="style" t-esc="balance['name']" />
                            </a>
                        </span>
                    </div>
                </t>
            </t>

            <!--## Initial balance-->
            <!-- <div class="act_as_cell amount">
                <t t-if="not show_partner_details">
                    <t t-if="balance['type'] == 'account_type'">
                        <t
                            t-set="domain"
                            t-value="[('account_id', '=', balance['id']),
                               ('date', '&lt;', date_from)]"
                        />
                        <span>
                            <a
                                t-att-data-domain="domain"
                                t-att-data-res-model="'account.move.line'"
                                class="o_account_financial_reports_web_action_monetary_multi"
                                t-att-style="style"
                            >
                                <t
                                    t-att-style="style"
                                    t-esc="balance['initial_balance']"
                                    t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"
                                />
                            </a>
                        </span>
                    </t>
                    <t t-if="balance['type'] == 'group_type'">
                        <span>
                            <a
                                t-att-data-domain="domain"
                                t-att-data-res-model="'account.move.line'"
                                class="o_account_financial_reports_web_action_monetary_multi"
                                t-att-style="style"
                            >
                                <t
                                    t-att-style="style"
                                    t-raw="balance['initial_balance']"
                                    t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"
                                />
                            </a>
                        </span>
                    </t>
                </t>
                <t t-if="type == 'partner_type'">
                    <t
                        t-set="domain"
                        t-value="[('account_id', '=', int(account_id)),
                                 ('partner_id', '=', int(partner_id)),
                                 ('date', '&lt;', date_from)]"
                    />
                    <span>
                        <a
                            t-att-data-domain="domain"
                            t-att-data-res-model="'account.move.line'"
                            class="o_account_financial_reports_web_action_monetary_multi"
                            t-att-style="style"
                        >
                            <t
                                t-att-style="style"
                                t-raw="total_amount[account_id][partner_id]['initial_balance']"
                                t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"
                            />
                        </a>
                    </span>
                </t>
            </div> -->
            <!--## Debit-->
            <div class="act_as_cell amount">
                <t t-if="not show_partner_details">
                    <t t-if="balance['type'] == 'account_type'">
                        <t
                            t-set="domain"
                            t-value="[('account_id', '=', balance['id']),
                                         ('date', '&gt;=', date_from),
                                         ('date', '&lt;=', date_to),
                                         ('debit', '&lt;&gt;', 0)]"
                        />
                        <span>
                            <a
                                t-att-data-domain="domain"
                                t-att-data-res-model="'account.move.line'"
                                class="o_account_financial_reports_web_action_monetary_multi"
                                t-att-style="style"
                            >
                                <t
                                    t-att-style="style"
                                    t-esc="debit"
                                    t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"
                                />
                            </a>
                        </span>
                    </t>
                    <t t-if="balance['type'] == 'group_type'">
                        <span>
                            <a
                                t-att-data-domain="domain"
                                t-att-data-res-model="'account.move.line'"
                                class="o_account_financial_reports_web_action_monetary_multi"
                                t-att-style="style"
                            >
                                <t
                                    t-att-style="style"
                                    t-raw="debit"
                                    t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"
                                />
                            </a>
                        </span>
                    </t>
                </t>
                <t t-if="type == 'partner_type'">
                    <t
                        t-set="domain"
                        t-value="[('account_id', '=', int(account_id)),
                                 ('partner_id', '=', int(partner_id)),
                                 ('date', '&gt;=', date_from),
                                 ('date', '&lt;=', date_to),
                                 ('debit', '&lt;&gt;', 0)]"
                    />
                    <span>
                        <a
                            t-att-data-domain="domain"
                            t-att-data-res-model="'account.move.line'"
                            class="o_account_financial_reports_web_action_monetary_multi"
                            t-att-style="style"
                        >
                            <t
                                t-att-style="style"
                                t-raw="total_amount[account_id][partner_id]['debit']"
                                t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"
                            />
                        </a>
                    </span>
                </t>
            </div>
            <!--## Credit-->
            <div class="act_as_cell amount">
                <t t-if="not show_partner_details">
                    <t t-if="balance['type'] == 'account_type'">
                        <t
                            t-set="domain"
                            t-value="[('account_id', '=', balance['id']),
                                         ('date', '&gt;=', date_from),
                                         ('date', '&lt;=', date_to),
                                         ('credit', '&lt;&gt;', 0)]"
                        />
                        <span>
                            <a
                                t-att-data-domain="domain"
                                t-att-data-res-model="'account.move.line'"
                                class="o_account_financial_reports_web_action_monetary_multi"
                                t-att-style="style"
                            >
                                <t
                                    t-att-style="style"
                                    t-esc="credit"
                                    t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"
                                />
                            </a>
                        </span>
                    </t>
                    <t t-if="balance['type'] == 'group_type'">
                        <span>
                            <a
                                t-att-data-domain="domain"
                                t-att-data-res-model="'account.move.line'"
                                class="o_account_financial_reports_web_action_monetary_multi"
                                t-att-style="style"
                            >
                                <t
                                    t-att-style="style"
                                    t-raw="credit"
                                    t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"
                                />
                            </a>
                        </span>
                    </t>
                </t>
                <t t-if="type == 'partner_type'">
                    <t
                        t-set="domain"
                        t-value="[('account_id', '=', int(account_id)),
                                 ('partner_id', '=', int(partner_id)),
                                 ('date', '&gt;=', date_from),
                                 ('date', '&lt;=', date_to),
                                 ('credit', '&lt;&gt;', 0)]"
                    />
                    <span>
                        <a
                            t-att-data-domain="domain"
                            t-att-data-res-model="'account.move.line'"
                            class="o_account_financial_reports_web_action_monetary_multi"
                            t-att-style="style"
                        >
                            <t
                                t-att-style="style"
                                t-raw="total_amount[account_id][partner_id]['credit']"
                                t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"
                            />
                        </a>
                    </span>
                </t>
            </div>
            <!--## Deudor-->
            <div class="act_as_cell amount">
                <t t-if="not show_partner_details">
                    <t t-if="balance['type'] == 'account_type'">
                        <t
                            t-set="domain"
                            t-value="[('account_id', '=', balance['id']),
                                         ('date', '&gt;=', date_from),
                                         ('date', '&lt;=', date_to),
                                         ('credit', '&lt;&gt;', 0)]"
                        />
                        <span>
                            <a
                                t-att-data-domain="domain"
                                t-att-data-res-model="'account.move.line'"
                                class="o_account_financial_reports_web_action_monetary_multi"
                                t-att-style="style"
                            >
                                <t
                                    t-att-style="style"
                                    t-esc="deudor"
                                    t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"
                                />
                            </a>
                        </span>
                    </t>
                    <t t-if="balance['type'] == 'group_type'">
                        <span>
                            <a
                                t-att-data-domain="domain"
                                t-att-data-res-model="'account.move.line'"
                                class="o_account_financial_reports_web_action_monetary_multi"
                                t-att-style="style"
                            >
                                <t
                                    t-att-style="style"
                                    t-raw="deudor"
                                    t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"
                                />
                            </a>
                        </span>
                    </t>
                </t>
                <t t-if="type == 'partner_type'">
                    <t
                        t-set="domain"
                        t-value="[('account_id', '=', int(account_id)),
                                 ('partner_id', '=', int(partner_id)),
                                 ('date', '&gt;=', date_from),
                                 ('date', '&lt;=', date_to),
                                 ('credit', '&lt;&gt;', 0)]"
                    />
                    <span>
                        <a
                            t-att-data-domain="domain"
                            t-att-data-res-model="'account.move.line'"
                            class="o_account_financial_reports_web_action_monetary_multi"
                            t-att-style="style"
                        >
                            <t
                                t-att-style="style"
                                t-raw="total_amount[account_id][partner_id]['credit']"
                                t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"
                            />
                        </a>
                    </span>
                </t>
            </div>
            <!--## Acreedor-->
            <div class="act_as_cell amount">
                <t t-if="not show_partner_details">
                    <t t-if="balance['type'] == 'account_type'">
                        <t
                            t-set="domain"
                            t-value="[('account_id', '=', balance['id']),
                                         ('date', '&gt;=', date_from),
                                         ('date', '&lt;=', date_to),
                                         ('credit', '&lt;&gt;', 0)]"
                        />
                        <span>
                            <a
                                t-att-data-domain="domain"
                                t-att-data-res-model="'account.move.line'"
                                class="o_account_financial_reports_web_action_monetary_multi"
                                t-att-style="style"
                            >
                                <t
                                    t-att-style="style"
                                    t-esc="acreedor"
                                    t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"
                                />
                            </a>
                        </span>
                    </t>
                    <t t-if="balance['type'] == 'group_type'">
                        <span>
                            <a
                                t-att-data-domain="domain"
                                t-att-data-res-model="'account.move.line'"
                                class="o_account_financial_reports_web_action_monetary_multi"
                                t-att-style="style"
                            >
                                <t
                                    t-att-style="style"
                                    t-raw="acreedor"
                                    t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"
                                />
                            </a>
                        </span>
                    </t>
                </t>
                <t t-if="type == 'partner_type'">
                    <t
                        t-set="domain"
                        t-value="[('account_id', '=', int(account_id)),
                                 ('partner_id', '=', int(partner_id)),
                                 ('date', '&gt;=', date_from),
                                 ('date', '&lt;=', date_to),
                                 ('credit', '&lt;&gt;', 0)]"
                    />
                    <span>
                        <a
                            t-att-data-domain="domain"
                            t-att-data-res-model="'account.move.line'"
                            class="o_account_financial_reports_web_action_monetary_multi"
                            t-att-style="style"
                        >
                            <t
                                t-att-style="style"
                                t-raw="total_amount[account_id][partner_id]['credit']"
                                t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"
                            />
                        </a>
                    </span>
                </t>
            </div>
            <!--## Activo-->
            <div class="act_as_cell amount">
                <t t-if="not show_partner_details">
                    <t t-if="balance['type'] == 'account_type'">
                        <t
                            t-set="domain"
                            t-value="[('account_id', '=', balance['id']),
                                         ('date', '&gt;=', date_from),
                                         ('date', '&lt;=', date_to),
                                         ('credit', '&lt;&gt;', 0)]"
                        />
                        <span>
                            <a
                                t-att-data-domain="domain"
                                t-att-data-res-model="'account.move.line'"
                                class="o_account_financial_reports_web_action_monetary_multi"
                                t-att-style="style"
                            >
                                <t
                                    t-att-style="style"
                                    t-esc="activo"
                                    t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"
                                />
                            </a>
                        </span>
                    </t>
                    <t t-if="balance['type'] == 'group_type'">
                        <span>
                            <a
                                t-att-data-domain="domain"
                                t-att-data-res-model="'account.move.line'"
                                class="o_account_financial_reports_web_action_monetary_multi"
                                t-att-style="style"
                            >
                                <t
                                    t-att-style="style"
                                    t-raw="activo"
                                    t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"
                                />
                            </a>
                        </span>
                    </t>
                </t>
                <t t-if="type == 'partner_type'">
                    <t
                        t-set="domain"
                        t-value="[('account_id', '=', int(account_id)),
                                 ('partner_id', '=', int(partner_id)),
                                 ('date', '&gt;=', date_from),
                                 ('date', '&lt;=', date_to),
                                 ('credit', '&lt;&gt;', 0)]"
                    />
                    <span>
                        <a
                            t-att-data-domain="domain"
                            t-att-data-res-model="'account.move.line'"
                            class="o_account_financial_reports_web_action_monetary_multi"
                            t-att-style="style"
                        >
                            <t
                                t-att-style="style"
                                t-raw="total_amount[account_id][partner_id]['credit']"
                                t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"
                            />
                        </a>
                    </span>
                </t>
            </div>
            <!--## Pasivo-->
            <div class="act_as_cell amount">
                <t t-if="not show_partner_details">
                    <t t-if="balance['type'] == 'account_type'">
                        <t
                            t-set="domain"
                            t-value="[('account_id', '=', balance['id']),
                                         ('date', '&gt;=', date_from),
                                         ('date', '&lt;=', date_to),
                                         ('credit', '&lt;&gt;', 0)]"
                        />
                        <span>
                            <a
                                t-att-data-domain="domain"
                                t-att-data-res-model="'account.move.line'"
                                class="o_account_financial_reports_web_action_monetary_multi"
                                t-att-style="style"
                            >
                                <t
                                    t-att-style="style"
                                    t-esc="pasivo"
                                    t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"
                                />
                            </a>
                        </span>
                    </t>
                    <t t-if="balance['type'] == 'group_type'">
                        <span>
                            <a
                                t-att-data-domain="domain"
                                t-att-data-res-model="'account.move.line'"
                                class="o_account_financial_reports_web_action_monetary_multi"
                                t-att-style="style"
                            >
                                <t
                                    t-att-style="style"
                                    t-raw="pasivo"
                                    t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"
                                />
                            </a>
                        </span>
                    </t>
                </t>
                <t t-if="type == 'partner_type'">
                    <t
                        t-set="domain"
                        t-value="[('account_id', '=', int(account_id)),
                                 ('partner_id', '=', int(partner_id)),
                                 ('date', '&gt;=', date_from),
                                 ('date', '&lt;=', date_to),
                                 ('credit', '&lt;&gt;', 0)]"
                    />
                    <span>
                        <a
                            t-att-data-domain="domain"
                            t-att-data-res-model="'account.move.line'"
                            class="o_account_financial_reports_web_action_monetary_multi"
                            t-att-style="style"
                        >
                            <t
                                t-att-style="style"
                                t-raw="total_amount[account_id][partner_id]['credit']"
                                t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"
                            />
                        </a>
                    </span>
                </t>
            </div>
            <!--## Pérdida-->
            <div class="act_as_cell amount">
                <t t-if="not show_partner_details">
                    <t t-if="balance['type'] == 'account_type'">
                        <t
                            t-set="domain"
                            t-value="[('account_id', '=', balance['id']),
                                         ('date', '&gt;=', date_from),
                                         ('date', '&lt;=', date_to),
                                         ('credit', '&lt;&gt;', 0)]"
                        />
                        <span>
                            <a
                                t-att-data-domain="domain"
                                t-att-data-res-model="'account.move.line'"
                                class="o_account_financial_reports_web_action_monetary_multi"
                                t-att-style="style"
                            >
                                <t
                                    t-att-style="style"
                                    t-esc="perdida"
                                    t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"
                                />
                            </a>
                        </span>
                    </t>
                    <t t-if="balance['type'] == 'group_type'">
                        <span>
                            <a
                                t-att-data-domain="domain"
                                t-att-data-res-model="'account.move.line'"
                                class="o_account_financial_reports_web_action_monetary_multi"
                                t-att-style="style"
                            >
                                <t
                                    t-att-style="style"
                                    t-raw="perdida"
                                    t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"
                                />
                            </a>
                        </span>
                    </t>
                </t>
                <t t-if="type == 'partner_type'">
                    <t
                        t-set="domain"
                        t-value="[('account_id', '=', int(account_id)),
                                 ('partner_id', '=', int(partner_id)),
                                 ('date', '&gt;=', date_from),
                                 ('date', '&lt;=', date_to),
                                 ('credit', '&lt;&gt;', 0)]"
                    />
                    <span>
                        <a
                            t-att-data-domain="domain"
                            t-att-data-res-model="'account.move.line'"
                            class="o_account_financial_reports_web_action_monetary_multi"
                            t-att-style="style"
                        >
                            <t
                                t-att-style="style"
                                t-raw="total_amount[account_id][partner_id]['credit']"
                                t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"
                            />
                        </a>
                    </span>
                </t>
            </div>
            <!--## Ganancia-->
            <div class="act_as_cell amount">
                <t t-if="not show_partner_details">
                    <t t-if="balance['type'] == 'account_type'">
                        <t
                            t-set="domain"
                            t-value="[('account_id', '=', balance['id']),
                                         ('date', '&gt;=', date_from),
                                         ('date', '&lt;=', date_to),
                                         ('credit', '&lt;&gt;', 0)]"
                        />
                        <span>
                            <a
                                t-att-data-domain="domain"
                                t-att-data-res-model="'account.move.line'"
                                class="o_account_financial_reports_web_action_monetary_multi"
                                t-att-style="style"
                            >
                                <t
                                    t-att-style="style"
                                    t-esc="ganancia"
                                    t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"
                                />
                            </a>
                        </span>
                    </t>
                    <t t-if="balance['type'] == 'group_type'">
                        <span>
                            <a
                                t-att-data-domain="domain"
                                t-att-data-res-model="'account.move.line'"
                                class="o_account_financial_reports_web_action_monetary_multi"
                                t-att-style="style"
                            >
                                <t
                                    t-att-style="style"
                                    t-raw="ganancia"
                                    t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"
                                />
                            </a>
                        </span>
                    </t>
                </t>
                <t t-if="type == 'partner_type'">
                    <t
                        t-set="domain"
                        t-value="[('account_id', '=', int(account_id)),
                                 ('partner_id', '=', int(partner_id)),
                                 ('date', '&gt;=', date_from),
                                 ('date', '&lt;=', date_to),
                                 ('credit', '&lt;&gt;', 0)]"
                    />
                    <span>
                        <a
                            t-att-data-domain="domain"
                            t-att-data-res-model="'account.move.line'"
                            class="o_account_financial_reports_web_action_monetary_multi"
                            t-att-style="style"
                        >
                            <t
                                t-att-style="style"
                                t-raw="total_amount[account_id][partner_id]['credit']"
                                t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"
                            />
                        </a>
                    </span>
                </t>
            </div>
        </div>
    </template>

    <template id="proandsys_reportes_chile_14.report_balance_tributario_qweb_line_subtotales">
        <!-- # line -->
        <div class="act_as_thead">
            <div class="act_as_row lines">
                <t t-if="not show_partner_details">    
                    <div class="act_as_cell left">
                        
                        <span>
                            Sub Total
                        </span>
                    </div>
                </t>
                <div class="act_as_cell left">
                    <span></span>
                </div>
                <div class="act_as_cell amount">
                        <span>
                            <a t-att-data-domain="domain"
                            t-att-data-res-model="'account.move.line'"
                            class="o_account_financial_reports_web_action_monetary_multi"
                            t-att-style="style">
                            <t t-att-style="style" t-raw="acumulador_debe" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/></a>
                        </span>
                </div>
                <!--## Credit-->
                <div class="act_as_cell amount">
                    <span>
                        <a t-att-data-domain="domain"
                        t-att-data-res-model="'account.move.line'"
                        class="o_account_financial_reports_web_action_monetary_multi"
                        t-att-style="style">
                        <t t-att-style="style" t-raw="acumulador_haber" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/></a>
                    </span>
                </div>
                <!--## Deudor-->
                <div class="act_as_cell amount">
                    <span>
                        <a t-att-data-domain="domain"
                        t-att-data-res-model="'account.move.line'"
                        class="o_account_financial_reports_web_action_monetary_multi"
                        t-att-style="style">
                        <t t-att-style="style" t-raw="acumulador_deudor" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/></a>
                    </span>
                </div>
                <!--## Acreedor-->
                <div class="act_as_cell amount">
                    <span>
                        <a t-att-data-domain="domain"
                        t-att-data-res-model="'account.move.line'"
                        class="o_account_financial_reports_web_action_monetary_multi"
                        t-att-style="style">
                        <t t-att-style="style" t-raw="acumulador_acreedor" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/></a>
                    </span>
                </div>

                <!--## Activo-->
                <div class="act_as_cell amount">
                    <span>
                        <a t-att-data-domain="domain"
                        t-att-data-res-model="'account.move.line'"
                        class="o_account_financial_reports_web_action_monetary_multi"
                        t-att-style="style">
                        <t t-att-style="style" t-raw="acumulador_activo" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/></a>
                    </span>
                </div>

                <!--## Pasivo-->
                <div class="act_as_cell amount">
                    <span>
                        <a t-att-data-domain="domain"
                        t-att-data-res-model="'account.move.line'"
                        class="o_account_financial_reports_web_action_monetary_multi"
                        t-att-style="style">
                        <t t-att-style="style" t-raw="acumulador_pasivo" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/></a>
                    </span>
                </div>
                <!--## Pérdida-->
                <div class="act_as_cell amount">
                    <span>
                        <a t-att-data-domain="domain"
                        t-att-data-res-model="'account.move.line'"
                        class="o_account_financial_reports_web_action_monetary_multi"
                        t-att-style="style">
                        <t t-att-style="style" t-raw="acumulador_perdida" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/></a>
                    </span>
                </div>

                <!--## Ganancia-->
                <div class="act_as_cell amount">
                    <span>
                        <a t-att-data-domain="domain"
                        t-att-data-res-model="'account.move.line'"
                        class="o_account_financial_reports_web_action_monetary_multi"
                        t-att-style="style">
                        <t t-att-style="style" t-raw="acumulador_ganancia" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/></a>
                    </span>
                </div>
            </div>
        </div>
    </template>
    <template id="proandsys_reportes_chile_14.report_balance_tributario_qweb_line_resultado">
        <!-- # line -->
        <t t-set="cero" t-value="0"/>
        <div class="act_as_thead">
            <div class="act_as_row lines">
                <t t-if="not show_partner_details">
                    <div class="act_as_cell left">
                        <span>
                            Resultado del Ejercicio
                        </span>
                    </div>
                </t>
                <div class="act_as_cell left">
                    <span></span>
                </div>
                <div class="act_as_cell amount">
                        <span>
                            <a t-att-data-domain="domain"
                            t-att-data-res-model="'account.move.line'"
                            class="o_account_financial_reports_web_action_monetary_multi"
                            t-att-style="style">
                            <t t-att-style="style" t-raw="cero" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/></a>
                        </span>
                </div>
                <!--## Credit-->
                <div class="act_as_cell amount">
                    <span>
                        <a t-att-data-domain="domain"
                        t-att-data-res-model="'account.move.line'"
                        class="o_account_financial_reports_web_action_monetary_multi"
                        t-att-style="style">
                        <t t-att-style="style" t-raw="cero" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/></a>
                    </span>
                </div>
                <!--## Deudor-->
                <div class="act_as_cell amount">
                    <span>
                        <a t-att-data-domain="domain"
                        t-att-data-res-model="'account.move.line'"
                        class="o_account_financial_reports_web_action_monetary_multi"
                        t-att-style="style">
                        <t t-att-style="style" t-raw="cero" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/></a>
                    </span>
                </div>
                <!--## Acreedor-->
                <div class="act_as_cell amount">
                    <span>
                        <a t-att-data-domain="domain"
                        t-att-data-res-model="'account.move.line'"
                        class="o_account_financial_reports_web_action_monetary_multi"
                        t-att-style="style">
                        <t t-att-style="style" t-raw="cero" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/></a>
                    </span>
                </div>

                <!--## Activo-->
                <div class="act_as_cell amount">
                    <span>
                        <a t-att-data-domain="domain"
                        t-att-data-res-model="'account.move.line'"
                        class="o_account_financial_reports_web_action_monetary_multi"
                        t-att-style="style">
                        <t t-att-style="style" t-raw="resultado_activo" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/></a>
                    </span>
                </div>

                <!--## Pasivo-->
                <div class="act_as_cell amount">
                    <span>
                        <a t-att-data-domain="domain"
                        t-att-data-res-model="'account.move.line'"
                        class="o_account_financial_reports_web_action_monetary_multi"
                        t-att-style="style">
                        <t t-att-style="style" t-raw="resultado_pasivo" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/></a>
                    </span>
                </div>
                <!--## Pérdida-->
                <div class="act_as_cell amount">
                    <span>
                        <a t-att-data-domain="domain"
                        t-att-data-res-model="'account.move.line'"
                        class="o_account_financial_reports_web_action_monetary_multi"
                        t-att-style="style">
                        <t t-att-style="style" t-raw="resultado_perdida" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/></a>
                    </span>
                </div>

                <!--## Ganancia-->
                <div class="act_as_cell amount">
                    <span>
                        <a t-att-data-domain="domain"
                        t-att-data-res-model="'account.move.line'"
                        class="o_account_financial_reports_web_action_monetary_multi"
                        t-att-style="style">
                        <t t-att-style="style" t-raw="resultado_ganancia" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/></a>
                    </span>
                </div>
            </div>
        </div>
    </template>
    <template id="proandsys_reportes_chile_14.report_balance_tributario_qweb_line_totales">
        <!-- # line -->
        <div class="act_as_thead">
            <div class="act_as_row lines">
                <t t-if="not show_partner_details">
                    <div class="act_as_cell left">
                        <span>
                            Total
                        </span>
                    </div>
                </t>
                <div class="act_as_cell left">
                    <span></span>
                </div>
                <div class="act_as_cell amount">
                        <span>
                            <a t-att-data-domain="domain"
                            t-att-data-res-model="'account.move.line'"
                            class="o_account_financial_reports_web_action_monetary_multi"
                            t-att-style="style">
                            <t t-att-style="style" t-raw="acumulador_debe" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/></a>
                        </span>
                </div>
                <!--## Credit-->
                <div class="act_as_cell amount">
                    <span>
                        <a t-att-data-domain="domain"
                        t-att-data-res-model="'account.move.line'"
                        class="o_account_financial_reports_web_action_monetary_multi"
                        t-att-style="style">
                        <t t-att-style="style" t-raw="acumulador_haber" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/></a>
                    </span>
                </div>
                <!--## Deudor-->
                <div class="act_as_cell amount">
                    <span>
                        <a t-att-data-domain="domain"
                        t-att-data-res-model="'account.move.line'"
                        class="o_account_financial_reports_web_action_monetary_multi"
                        t-att-style="style">
                        <t t-att-style="style" t-raw="acumulador_deudor" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/></a>
                    </span>
                </div>
                <!--## Acreedor-->
                <div class="act_as_cell amount">
                    <span>
                        <a t-att-data-domain="domain"
                        t-att-data-res-model="'account.move.line'"
                        class="o_account_financial_reports_web_action_monetary_multi"
                        t-att-style="style">
                        <t t-att-style="style" t-raw="acumulador_acreedor" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/></a>
                    </span>
                </div>

                <!--## Activo-->
                <div class="act_as_cell amount">
                    <span>
                        <a t-att-data-domain="domain"
                        t-att-data-res-model="'account.move.line'"
                        class="o_account_financial_reports_web_action_monetary_multi"
                        t-att-style="style">
                        <t t-att-style="style" t-raw="acumulador_activo+resultado_activo" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/></a>
                    </span>
                </div>

                <!--## Pasivo-->
                <div class="act_as_cell amount">
                    <span>
                        <a t-att-data-domain="domain"
                        t-att-data-res-model="'account.move.line'"
                        class="o_account_financial_reports_web_action_monetary_multi"
                        t-att-style="style">
                        <t t-att-style="style" t-raw="acumulador_pasivo+resultado_pasivo" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/></a>
                    </span>
                </div>
                <!--## Pérdida-->
                <div class="act_as_cell amount">
                    <span>
                        <a t-att-data-domain="domain"
                        t-att-data-res-model="'account.move.line'"
                        class="o_account_financial_reports_web_action_monetary_multi"
                        t-att-style="style">
                        <t t-att-style="style" t-raw="acumulador_perdida+resultado_perdida" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/></a>
                    </span>
                </div>

                <!--## Ganancia-->
                <div class="act_as_cell amount">
                    <span>
                        <a t-att-data-domain="domain"
                        t-att-data-res-model="'account.move.line'"
                        class="o_account_financial_reports_web_action_monetary_multi"
                        t-att-style="style">
                        <t t-att-style="style" t-raw="acumulador_ganancia+resultado_ganancia" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/></a>
                    </span>
                </div>
            </div>
        </div>
    </template>   

    <template id="proandsys_reportes_chile_14.report_balance_tributario_qweb_ejercicio_anterior">
        <div class="act_as_cell left">
            <span>
                Resultado del Ejercicio anterior
            </span>
        </div>
        <div class="act_as_cell amount">    
            <span t-esc="resultado_ejercicio_anterior['initial_balance']" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
        </div>
    </template> 



    <template id="proandsys_reportes_chile_14.report_trial_balance_account_footer">
        <!-- Display ending balance line for account or partner -->
        <div class="act_as_table list_table" style="width: 100%;">
            <div class="act_as_row labels" style="font-weight: bold;">
                <!--## date-->
                <div class="act_as_cell first_column" style="width: 33%;">
                        <span t-esc="accounts_data[account_id]['code']" />
                        -
                        <span t-esc="accounts_data[account_id]['name']" />
                    </div>
                <!--## Initial Balance-->
                <div class="act_as_cell amount" style="width: 9%;">
                    <span
                        t-esc="total_amount[account_id]['initial_balance']"
                        t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"
                    />
                </div>
                <!--## Debit-->
                <div class="act_as_cell amount" style="width: 9%;">
                    <span
                        t-esc="total_amount[account_id]['debit']"
                        t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"
                    />
                </div>
                <!--## Credit-->
                <div class="act_as_cell amount" style="width: 9%;">
                    <span
                        t-esc="total_amount[account_id]['credit']"
                        t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"
                    />
                </div>
                <!--## Period balance-->
                <div class="act_as_cell amount" style="width: 9%;">
                    <span
                        t-esc="total_amount[account_id]['balance']"
                        t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"
                    />
                </div>
                <!--## Ending balance-->
                <div class="act_as_cell amount" style="width: 9%;">
                    <span
                        t-esc="total_amount[account_id]['ending_balance']"
                        t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"
                    />
                </div>
            </div>
        </div>
    </template>
</odoo>
